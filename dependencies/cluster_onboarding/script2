CREATE INDEX appIdSearch IF NOT EXISTS FOR (n:APPLICATION) ON (n.id_);
CREATE INDEX appAliasesSearch IF NOT EXISTS FOR (n:APPLICATION) ON (n.aliases);
CREATE INDEX appDomainSearch IF NOT EXISTS FOR (n:APPLICATION) ON (n.domain);
CREATE FULLTEXT INDEX appSearch IF NOT EXISTS FOR (n:APPLICATION) ON EACH [n.domain, n.name];
CREATE FULLTEXT INDEX userSearch IF NOT EXISTS FOR (n:USER) ON EACH [n.displayName, n.jobTitle];
CREATE INDEX userIdSearch IF NOT EXISTS FOR (n:USER) ON (n.id);
CREATE INDEX userTenantSearch IF NOT EXISTS FOR (n:USER) ON (n.subscriber, n.tenant);
CREATE INDEX userMailSearch IF NOT EXISTS FOR (n:USER) ON (n.mail);
CREATE INDEX emailTenantSearch IF NOT EXISTS FOR (n:EMAIL) ON (n.subscriber, n.tenant);
CREATE INDEX accountIdSearch IF NOT EXISTS FOR (n:ACCOUNT) ON (n.id);
CREATE INDEX accountEmailSearch IF NOT EXISTS FOR (n:ACCOUNT) ON (n.email);
CREATE INDEX accountTenantSearch IF NOT EXISTS FOR (n:ACCOUNT) ON (n.subscriber, n.tenant);
CREATE INDEX findingIdSearch IF NOT EXISTS FOR (n:FINDING) ON (n.id);
CREATE INDEX findingTenantSearch IF NOT EXISTS FOR (n:FINDING) ON (n.subscriber, n.tenant);
CREATE FULLTEXT INDEX departmentSearch IF NOT EXISTS FOR (n:DEPARTMENT) ON EACH [n.name];
CREATE INDEX groupUserDefinedSearch IF NOT EXISTS FOR (n:GROUP) ON (n.userDefined);
CREATE FULLTEXT INDEX groupSearch IF NOT EXISTS FOR (n:GROUP) ON EACH [n.displayName];
CREATE FULLTEXT INDEX appCategorySearch IF NOT EXISTS FOR (n:APP_CATEGORY) ON EACH [n.name];
CREATE INDEX credsbasedAccountLastAccessed IF NOT EXISTS FOR ()-[r:CREDSBASED_ACCOUNT]->() ON r.last_access_time;
CREATE INDEX oauthAccountLastAccessed IF NOT EXISTS FOR ()-[r:OAUTH_ACCOUNT]->() ON r.last_access_time;
CREATE INDEX samlAccountLastAccessed IF NOT EXISTS FOR ()-[r:SAML_ACCOUNT]->() ON r.last_access_time;
CREATE INDEX guestAccountLastAccessed IF NOT EXISTS FOR ()-[r:GUEST_ACCOUNT]->() ON r.last_access_time;
CREATE INDEX behaviorIdSearch IF NOT EXISTS FOR (n:BEHAVIOR) ON (n.id);
CREATE INDEX findingTimestampSearch IF NOT EXISTS FOR (n:FINDING) ON (n.timestamp);
CREATE INDEX findingHistoryTimestampSearch IF NOT EXISTS FOR (n:FINDING_HISTORY) ON (n.timestamp);
CREATE INDEX tenantIdSearch IF NOT EXISTS FOR (n:TENANT) ON (n.id);
CREATE INDEX emailIdSearch IF NOT EXISTS FOR (n:EMAIL) ON (n.id);
CREATE INDEX actionIdSearch IF NOT EXISTS FOR (n:ACTION) ON (n.id);
CREATE INDEX outcomeIdSearch IF NOT EXISTS FOR (n:OUTCOME) ON (n.id);
CREATE INDEX whitelistedforTenantSearch IF NOT EXISTS FOR ()-[r:WHITELISTED_FOR]-() ON (r.tenant);
CREATE INDEX usingAppTimestampSearch IF NOT EXISTS FOR ()-[r:USING_APP]-() ON (r.timestamp);
CREATE INDEX hasAppSettingsCriticalitySearch IF NOT EXISTS FOR ()-[r:HAS_APP_SETTINGS]-() ON (r.criticality);
CREATE INDEX hasAppSettingsApprovalStatusSearch IF NOT EXISTS FOR ()-[r:HAS_APP_SETTINGS]-() ON (r.approval_status);
CREATE INDEX scopeSeveritySearch IF NOT EXISTS FOR (n:SCOPE) ON (n.severity);
