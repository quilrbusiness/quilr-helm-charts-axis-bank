CREATION OF SECRETS:

acr docker registry secret --> acr-secret
azure storage account secret --> azure-secret

kubectl create secret docker-registry acr-secret --docker-server=quilrdev.azurecr.io --docker-username=quilrdev --docker-password=uKhRi1v3I1QdKGjWRbuaJn1vgIVyA4/SFTkJnGNNeg+ACRBSDz6X  -n quilr

kubectl create secret generic azure-secret --from-literal=azurestorageaccountname=staticcontent1 --from-literal=azurestorageaccountkey=CxMfBJjVIV1e0vT29+yUtcSRmwZ2UVk1L7FOiKgsiYo+Hs7gtuOdxrhRvGiIcc1zFO3VF7sivkU9+AStGCnOrQ==  -n quilr  

mkdir QUILR_PUBLIC_PRIVATE_KEYS
cd QUILR_PUBLIC_PRIVATE_KEYS



wget --header="Authorization: token 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" \
     https://raw.githubusercontent.com/quilrbusiness/quilr-deployment-scripts/main/Keys/QUILR_PRIVATE_KEY \
     -O QUILR_PRIVATE_KEY
	 
wget --header="Authorization: token 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" \
     https://raw.githubusercontent.com/quilrbusiness/quilr-deployment-scripts/main/Keys/QUILR_PUBLIC_KEY \
     -O QUILR_PUBLIC_KEY



kubectl create secret generic auth-key-public --from-file=/home/azure-user/QUILR_PUBLIC_PRIVATE_KEYS/QUILR_PUBLIC_KEY -n quilr

kubectl create secret generic auth-keys --from-file=/home/azure-user/QUILR_PUBLIC_PRIVATE_KEYS/QUILR_PRIVATE_KEY --from-file=/home/ssm-user/QUILR_PUBLIC_PRIVATE_KEYS/QUILR_PUBLIC_KEY  -n quilr


kubectl exec -n quilr "quilr-db-elasticsearch-master-0" -c elasticsearch -- cat "/opt/bitnami/elasticsearch/config/certs/ca.crt" > quilr-db-elasticsearch-ca.crt

keytool -import -file quilr-db-elasticsearch-ca.crt -alias elastic-db-quilr-prod-sentara -keystore truststore.jks -storepass rgukt123

kubectl create secret generic quilr-elasticsearch-db-trustore --from-file=truststore.jks=./truststore.jks -n quilr

kubectl get secret vault-tls --namespace=quilr -o jsonpath="{.data.ca\.crt}" | base64 --decode > $PWD/vault-ca.crt

keytool -import -file vault-ca.crt -alias vault-quilr-prod-truststore-sentara -keystore truststore-vault.jks -storepass rgukt123

kubectl create secret generic quilr-vault-trustore --from-file=truststore.jks=truststore-vault.jks -n quilr

cp quilr-db-elasticsearch-ca.crt es_server.pem

kubectl create secret generic quilr-es-db-certs-prod-saas   --from-file=es_server.pem=es_server.pem -n quilr

openssl x509 -in vault-ca.crt -out ca_chain.pem -outform PEM

kubectl create secret generic quilr-vault-capem --from-file=ca_chain.pem=ca_chain.pem -n quilr
