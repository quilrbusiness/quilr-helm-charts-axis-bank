WITH VAULT-CLI BEING INSTALLED --  INSERTING SECRETS INTO VAULT FROM THE CLI

vault kv get secret/quilr-common-config-vault
WARNING! VAULT_ADDR and -address unset. Defaulting to https://127.0.0.1:8200.
Get "https://127.0.0.1:8200/v1/sys/internal/ui/mounts/secret/quilr-common-config-vault": dial tcp 127.0.0.1:8200: connect: connection refused

Port-forward Vault (runs in background)
-----------

kubectl -n quilr port-forward svc/vault 8200:8200 >/tmp/vault-pf.log 2>&1 & echo $! > /tmp/vault-pf.pid

stop the port forwarded kill 
----------

$(cat /tmp/vault-pf.pid) 2>/dev/null || pkill -f 'kubectl.*port-forward.*svc/vault.*8200'

Point Vault CLI at the forwarded port

export VAULT_ADDR=https://127.0.0.1:8200
export VAULT_SKIP_VERIFY=true 
export VAULT_TOKEN=$(kubectl get secrets vault-unseal-keys --namespace=quilr -o jsonpath={.data.vault-root} | base64 --decode)
echo $VAULT_TOKEN


export VAULT_TOKEN=hvs.WmSEUZeYA2hEhgBpD1ZRVFIC
echo $VAULT_TOKEN

vault status

Key                     Value
---                     -----
Seal Type               shamir
Initialized             true
Sealed                  false
Total Shares            5
Threshold               3
Version                 1.14.1
Build Date              2023-07-21T10:15:14Z
Storage Type            raft
Cluster Name            vault-cluster-fe09af4c
Cluster ID              f288b2cc-e30d-0bf7-2aee-dc91949cb25f
HA Enabled              true
HA Cluster              https://vault-1:8201
HA Mode                 active
Active Since            2025-08-22T10:39:09.382830283Z
Raft Committed Index    193510
Raft Applied Index      193510



vault kv get secret/quilr-common-config-vault

vault kv metadata get secret/quilr-common-config-vault

============ Secret Path ============
secret/data/quilr-common-config-vault

======= Metadata =======
Key                Value
---                -----
created_time       2025-08-25T04:58:54.398857108Z
custom_metadata    <nil>
deletion_time      n/a
destroyed          false
version            27

=================== Data ===================
Key                                    Value
---                                    -----
ACCESS_TOKEN                           https://login.microsoftonline.com/XXXXXXXXX/oauth2/v2.0/token
ANTHROPIC_API_KEY                      sk-ant-api03-XXXXXXXXXXX-C4uBjefXPuHfK_o0gYmSwhEbkq-XXXXXXXXXXXXXXXXXXXXX
AZURE_API_KEY                          XXXXXXXXXXXXXXXXXXXXXXXX
AZURE_API_VERSION                      2025-01-01-preview

 vault kv metadata get secret/quilr-common-config-vault
============= Metadata Path =============
secret/metadata/quilr-common-config-vault

========== Metadata ==========
Key                     Value
---                     -----
cas_required            false
created_time            2025-04-11T07:50:28.769999666Z
current_version         27
custom_metadata         <nil>
delete_version_after    0s
max_versions            0
oldest_version          18
updated_time            2025-08-25T04:58:54.398857108Z

===== Version 18 =====
Key              Value
---              -----
created_time     2025-07-10T08:13:25.372151425Z
deletion_time    n/a
destroyed        false

===== Version 19 =====
Key              Value
---              -----
created_time     2025-07-10T08:16:55.147092583Z
deletion_time    n/a
destroyed        false

===== Version 20 =====
Key              Value
---              -----
created_time     2025-07-10T08:21:35.181061887Z
deletion_time    n/a
destroyed        false

===== Version 21 =====
Key              Value
---              -----
created_time     2025-07-29T13:59:16.147658305Z
deletion_time    n/a
destroyed        false

===== Version 22 =====
Key              Value
---              -----
created_time     2025-07-29T14:03:20.054485843Z
deletion_time    n/a
destroyed        false


vault kv get -version=14 secret/quilr-common-config-vault

vault kv patch secret/quilr-common-config-vault  quilr='security'

vault kv patch secret/quilr-common-config-vault  quilr='security'

============ Secret Path ============
secret/data/quilr-common-config-vault

======= Metadata =======
Key                Value
---                -----
created_time       2025-08-28T12:26:26.753839944Z
custom_metadata    <nil>
deletion_time      n/a
destroyed          false
version            28

vault kv patch secret/quilr-common-config-vault  quilr1='security1'
============ Secret Path ============
secret/data/quilr-common-config-vault

======= Metadata =======
Key                Value
---                -----
created_time       2025-08-28T12:27:07.802220939Z
custom_metadata    <nil>
deletion_time      n/a
destroyed          false
version            29
 

stop the port forwarded kill 

$(cat /tmp/vault-pf.pid) 2>/dev/null || pkill -f 'kubectl.*port-forward.*svc/vault.*8200'
